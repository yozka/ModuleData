#include "Adapter.h"
#include "DataSource.h"
///--------------------------------------------------------------------------------------



///--------------------------------------------------------------------------------------
using namespace DataSource;
///--------------------------------------------------------------------------------------










 ///=====================================================================================
///
/// Constructor
/// 
/// 
///--------------------------------------------------------------------------------------
AAdapter :: AAdapter ()
{

}
///--------------------------------------------------------------------------------------







 ///=====================================================================================
///
/// Destructor
/// 
/// 
///--------------------------------------------------------------------------------------
AAdapter :: ~AAdapter ()
{
	disconnectDataSource();

}
///--------------------------------------------------------------------------------------










 ///=====================================================================================
///
/// 
/// 
/// 
///--------------------------------------------------------------------------------------
void AAdapter :: connectDataSource(const QSharedPointer<ADataSource> &dataSource)
{
	if (dataSource.isNull())
	{
		disconnectDataSource();
		return;
	}

	if (mDataSource == dataSource)
	{
		//инциализация уже была
		return;
	}

	disconnectDataSource();
	mDataSource = dataSource;
	dataSource->connectAdapter(sharedFromThis());
}
///--------------------------------------------------------------------------------------







 ///=====================================================================================
///
/// отключаем источник данных
/// 
/// 
///--------------------------------------------------------------------------------------
void AAdapter :: disconnectDataSource()
{
	if (mDataSource.isNull())
	{
		return;
	}

	mDataSource.data()->disconnectAdapter(sharedFromThis());
	mDataSource = PDataSource();
}
